<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Sturdy Climb+ (No Wheel Collapse!)</title>
  <style>
    body,html{margin:0;padding:0;height:100%;background:#222;color:#eee;font-family:sans-serif;}
    #stage{position:relative;width:100%;max-width:900px;height:400px;margin:20px auto;background:#111;overflow:hidden;}
    #overlay{position:absolute;inset:0;background:rgba(0,0,0,0.7);display:flex;align-items:center;justify-content:center;z-index:10;}
    #overlay.hidden{display:none}
    #startBtn{padding:12px 24px;font-size:18px;cursor:pointer;}
    #hud{position:absolute;bottom:10px;right:10px;background:rgba(0,0,0,0.5);padding:6px;border-radius:4px;z-index:20;}
  </style>
</head>
<body>
  <div id="stage">
    <div id="overlay"><button id="startBtn">Start Driving</button></div>
    <div id="hud">Distance: 0 m</div>
  </div>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/matter-js/0.20.0/matter.min.js"></script>
  <script type="module">
import { createNoise2D } from 'https://cdn.jsdelivr.net/npm/simplex-noise@4.0.3/+esm';
const { Engine, Render, Runner, World, Bodies, Events, Body } = Matter;

// --- Setup basics ---
const engine = Engine.create({ gravity: { x:0, y:1.2 } });
const render = Render.create({ element: document.getElementById('stage'), engine, options:{ width:900, height:400, wireframes:false, background:'#111' } });
Render.run(render);
Runner.run(Runner.create(), engine);

// --- Terrain generation ---
const noise2D = createNoise2D();
let maxX = -300, SEG_W=60, AMP=100, SCALE=0.003;
function addTerrain(toX){
  for(let x=maxX; x<toX; x+=SEG_W){
    const y0 = 300 - noise2D(x * SCALE,0)*AMP;
    const y1 = 300 - noise2D((x + SEG_W)*SCALE,0)*AMP;
    const seg = Bodies.rectangle(x + SEG_W/2, (y0+y1)/2 + 50, SEG_W, 400 - (y0+y1)/2, {
      isStatic:true,
      render:{ fillStyle:'#444' }
    });
    World.add(engine.world, seg);
  }
  maxX = toX;
}
addTerrain(900);

// --- Car with manual control (no torque) ---
const car = Bodies.rectangle(100, 200, 80, 20, { friction: 0.6, restitution: 0.2 });
World.add(engine.world, car);

const keys = { left:false, right:false };
window.addEventListener('keydown',e=>{
  if(e.code==='ArrowRight') keys.right = true;
  if(e.code==='ArrowLeft') keys.left = true;
  document.getElementById('overlay').classList.add('hidden');
});
window.addEventListener('keyup',e=>{
  if(e.code==='ArrowRight') keys.right = false;
  if(e.code==='ArrowLeft') keys.left = false;
});

// --- Movement logic ---
Events.on(engine, 'beforeUpdate', ()=>{
  if(keys.right) Body.applyForce(car, car.position, { x: 0.0005, y: 0 });
  if(keys.left) Body.applyForce(car, car.position, { x: -0.0005, y: 0 });
});

// --- Camera & HUD updates ---
const hud = document.getElementById('hud');
Events.on(engine, 'afterUpdate', ()=>{
  addTerrain(car.position.x + 600);
  hud.textContent = `Distance: ${Math.floor(car.position.x - 100)} m`;
  Render.lookAt(render, car, { x: 200, y: 200 });
});
  </script>
</body>
</html>
